<script>
    const apiKey = 'AIzaSyCb9GeLx7UcqkvXj3Oy3F6e1B9XAvMLE4A';
    const spreadsheetId = '1hJVqPsSUdo5wyJ7yVO_Fs-UkHrsQDIhvX4EMejgbAXc';
    const packingRange = 'datapacking!A2:D';
    const gudangRange = 'datagudang!A2:A';
    const rakRange = 'inputrak!A2:A';
    const packingUrl = `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/${packingRange}?key=${apiKey}`;
    const gudangUrl = `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/${gudangRange}?key=${apiKey}`;
    const rakUrl = `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/${rakRange}?key=${apiKey}`;

    function updateTime() {
        const now = new Date();
        const timeString = now.toLocaleTimeString('id-ID', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
        document.getElementById('msku2').value = timeString;
    }

    function fetchGudangData() {
        fetch(gudangUrl)
            .then(response => response.json())
            .then(data => {
                const gudangSelect = document.getElementById('msku6');
                data.values.forEach(value => {
                    const option = document.createElement('option');
                    option.value = value[0];
                    option.textContent = value[0];
                    gudangSelect.appendChild(option);
                });
            })
            .catch(error => console.error('Error fetching data:', error));
    }

    function fetchRakData() {
        fetch(rakUrl)
            .then(response => response.json())
            .then(data => {
                const rakSelects = document.querySelectorAll('select[name="msku7"]');
                rakSelects.forEach(select => {
                    data.values.forEach(value => {
                        const option = document.createElement('option');
                        option.value = value[0];
                        option.textContent = value[0];
                        select.appendChild(option);
                    });
                });
            })
            .catch(error => console.error('Error fetching data:', error));
    }

    function fetchPackingData() {
        fetch(packingUrl)
            .then(response => response.json())
            .then(data => {
                const packingData = data.values.map(row => row[0]);
                const dropdownList = document.getElementById('dropdownList');
                dropdownList.innerHTML = ''; // Clear previous items
                packingData.forEach(item => {
                    const div = document.createElement('div');
                    div.className = 'dropdown-item';
                    div.textContent = item;
                    div.onclick = () => {
                        document.getElementById('msku3').value = item;
                        dropdownList.classList.remove('active');
                    };
                    dropdownList.appendChild(div);
                });
            })
            .catch(error => console.error('Error fetching data:', error));
    }

    function filterDropdown(input) {
        const filter = input.value.toLowerCase();
        const dropdownList = input.nextElementSibling;
        const items = dropdownList.getElementsByClassName('dropdown-item');
        let firstVisibleItem = null;

        Array ```javascript
.from(items).forEach(item => {
            if (item.textContent.toLowerCase().includes(filter)) {
                item.style.display = '';
                if (!firstVisibleItem) {
                    firstVisibleItem = item;
                }
            } else {
                item.style.display = 'none';
            }
        });

        if (firstVisibleItem) {
            firstVisibleItem.classList.add('highlighted');
        }

        dropdownList.classList.add('active');
    }

    document.addEventListener('keydown', function(event) {
        const dropdownList = document.getElementById('dropdownList');
        if (dropdownList.classList.contains('active')) {
            const highlightedItem = dropdownList.querySelector('.highlighted');
            let newHighlightedItem;

            if (event.key === 'ArrowDown') {
                newHighlightedItem = highlightedItem ? highlightedItem.nextElementSibling : dropdownList.firstElementChild;
                while (newHighlightedItem && newHighlightedItem.style.display === 'none') {
                    newHighlightedItem = newHighlightedItem.nextElementSibling;
                }
            } else if (event.key === 'ArrowUp') {
                newHighlightedItem = highlightedItem ? highlightedItem.previousElementSibling : dropdownList.lastElementChild;
                while (newHighlightedItem && newHighlightedItem.style.display === 'none') {
                    newHighlightedItem = newHighlightedItem.previousElementSibling;
                }
            }

            if (newHighlightedItem) {
                if (highlightedItem) {
                    highlightedItem.classList.remove('highlighted');
                }
                newHighlightedItem.classList.add('highlighted');
                newHighlightedItem.scrollIntoView({ block: 'nearest' });
            }
        }
    });

    window.onload = function() {
        updateTime();
        fetchGudangData();
        fetchPackingData();
        fetchRakData();
    };
</script>
